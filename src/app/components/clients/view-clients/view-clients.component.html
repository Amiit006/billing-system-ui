<div class="container">
  <h2 class="starter-template">All Clients</h2>

  <input type="search"
         (keyup)="doFilter($event.target.value)"
         placeholder="Search with name"
         class="form-control mb-2 mt-2">

  <!-- Desktop / Tablet: normal Material table -->
  <ng-container *ngIf="(isHandset$ | async) === false; else mobileList">
    <table mat-table [dataSource]="dataSource" matSort class="mat-elevation-z8 fullwidth">

      <ng-container matColumnDef="clientName">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Client Name</th>
        <td mat-cell *matCellDef="let e">{{ e.clientName }}</td>
      </ng-container>

      <ng-container matColumnDef="mobile">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Mobile</th>
        <td mat-cell *matCellDef="let e">{{ e.mobile }}</td>
      </ng-container>

      <ng-container matColumnDef="storeName">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Store Name</th>
        <td mat-cell *matCellDef="let e">{{ e.address?.storeName }}</td>
      </ng-container>

      <ng-container matColumnDef="city">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>City</th>
        <td mat-cell *matCellDef="let e">{{ e.address?.city }}</td>
      </ng-container>

      <ng-container matColumnDef="action">
        <th mat-header-cell *matHeaderCellDef>Action</th>
        <td mat-cell *matCellDef="let e">
          <a [routerLink]="'/clients/' + e.clientId" mat-flat-button color="primary" class="mr-2">View</a>
          <button mat-flat-button color="primary" (click)="onNewBillClick(e.clientId)">Create a bill</button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>

    <mat-paginator [pageSizeOptions]="[5, 10, 20]" showFirstLastButtons></mat-paginator>
  </ng-container>

  <!-- Mobile: card list -->
  <ng-template #mobileList>
    <div class="card-list">
      <mat-card class="client-card mat-elevation-z2" *ngFor="let e of dataSource.filteredData">
        <mat-card-title class="card-title">{{ e.clientName }}</mat-card-title>
        <mat-card-subtitle>{{ e.address?.storeName }}</mat-card-subtitle>

        <div class="kv">
          <div><span>Mobile</span>{{ e.mobile }}</div>
          <div><span>City</span>{{ e.address?.city }}</div>
        </div>

        <div class="actions">
          <a [routerLink]="'/clients/' + e.clientId" mat-stroked-button color="primary">View</a>
          <button mat-flat-button color="primary" (click)="onNewBillClick(e.clientId)">Create a bill</button>
        </div>
      </mat-card>
    </div>
  </ng-template>
</div>
